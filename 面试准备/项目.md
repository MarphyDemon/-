# 项目介绍

## 项目难点以及怎么解决的？

### 订单列表动态化

背景：美团点餐小程序 2.0 版本中，订单列表需要支持动态化展示。原有的订单列表是静态的，无法根据不同的业务需求进行灵活调整。在新的订单接入需求中，不可避免的需要增加新的订单卡片和按钮行为。由于订单列表的复杂性，静态化的方式难以满足业务需求。且会导致包体逐渐增加，影响小程序的性能和用户体验。

解决方案：采用**数据驱动渲染的方式**，通过原子组件和动态化渲染方案提升灵活性。在订单列表中，使用了**原子组件**来实现不同的订单内容展示。通过行为协议抽象，将不同订单按钮的行为进行分类，使用**行为协议**来实现不同的订单按钮的行为。通过这种方式，订单列表可以根据不同的业务需求进行灵活调整，提升了系统的灵活性和可扩展性。

实现过程：最先调研方案，现有市场内无小程序端动态化渲染的方案，参考 h5 的动态化渲染方案，结合小程序特性 template，提出了**数据驱动渲染**的方案，探索过程中发现首屏通过数据驱动，还需要增加统一行为定义，实现不同按钮的抽象。

项目难点：
1）渲染模型设计复杂，需要先实现页面的 demo，将其转换为渲染 json 模型，再由后端填充业务数据。
2）需要考虑到小程序的性能问题，动态化渲染会增加页面的复杂性和性能开销，需要进行性能优化。
3）动态化渲染模型下，如何进行按钮的行为抽象和协议设计，实现不同的按钮功能。

最终结果：
1）一期采用 json 渲染串的方式，提供给服务端多个渲染串，服务端根据不同的业务填充组合渲染串，最终返回该渲染串给小程序进行渲染。
2）二期采用 freeMarker，前端编写小程序 wxml，将其转换成 xml 模版存储在服务器上，后端通过模板引擎将数据填充到模板中，使用 JSON 转换工具，将其转换为 json 渲染串，返回给小程序进行渲染。

结果优点：
1）提升了订单列表的灵活性和可扩展性，支持动态化渲染。
2）提升了小程序的性能，控制包体增量，提升了用户体验。
3）提升了系统的可维护性，降低了后续的维护成本。

缺点：
1）动态化方案可能会出现层级渲染极深，导致性能问题，所以适用场景有限。
2）动态化渲染在不同的小程序中存在兼容性问题，例如模板的声明。
3）动态化渲染 scroll-view 组件下拉加载无法直接使用，需二次封装。

### 小程序性能优化

## 1.0 小程序到 2.0 小程序做了什么？怎么提升性能的？

美团点餐团队针对**KA 连锁客户市场**推出商家品牌小程序点餐 2.0，目标是**性能体验追齐行业最佳**。1.0 自 16 年开始迭代，整体架构存在**历史包袱重**、**茶饮业态体验不足**问题，需通过**分业态模式**重构。**核心方案**采用渐进式迭代：先实现**扩展点模式 B**（后端控制模块布局），再优化为**模式 C**（编译时移除无用模块），最终目标**模式 E**（全预加载最优渲染）。
架构设计**关键创新**包括：
1）**模块化分层**（页面-模块-组件三级结构）；
2）增加容器能力：依赖注入容器。容器管理页面内所有的实体，容器提供统一的实体绑定和访问能力，且提供外部依赖注入的能力。
增强能力：包括页面级别的 UI 增强能力，如主题色、统一弹框等，以及逻辑增强能力，如事件管理等。
3）**扩展点机制**支持多业态定制（模块/组件/逻辑三种扩展类型）。非首屏内容及逻辑可通过服务端控制，按需加载。首屏内容和逻辑通过编译时移除无用模块，达到**首屏即达**的效果。
4）结合小程序特性，减少跨页面缓存滥用，降低跨页面耦合，避免过度缓存导致的性能问题。

**重要协议**首屏渲染采用数据驱动，非首屏数据异步加载。该设计通过**解耦业务与渲染逻辑**，显著提升可维护性和跨业态扩展能力，同时**保持核心架构稳定**。

## 项目有什么改进的地方，你认为有哪些地方还可以继续优化？

1）长列表优化。目前菜单页商家可配置菜品数量，超过 300 个菜品时，页面卡顿导致体验下降。
2）编译时无法根据业务场景进行编译，导致包体过大。后续需探索如何根据商家的使用场景发布不同的包体。

## 2.0 小程序的性能提升了多少？怎么测试的？

页面性能平均提升 60%，具体测试方法如下：
1） 启动耗时：`wx.getPerformance()` API 采集
2） 渲染性能：PerfDog 监测 FPS/GPU 使用率
3） 内存分析：Android Profiler/iOS Instruments
4） 网络请求：Charles 抓包分析 TTFB/TTFM
5） 录制回放：分析页面渲染性能
6） 性能监控：使用前端性能检测工具，上报性能数据到服务端，进行性能分析和监控。

平常周会复盘上周性能数据，异常数据进行分析，排查迭代新增问题代码是否可能产生影响。

## 你在项目中做了哪些工作？你在这个项目中负责什么？

1）负责项目的整体架构设计，参与了项目的需求分析和技术选型。
2）负责项目的模块化、实体、扩展点设计，参与了模块的拆分和重构。
3）负责项目的性能优化，参与了性能测试和性能分析。
4）负责项目的代码 review，参与了代码的质量控制和规范制定。
5）负责项目的文档编写，参与了项目的技术文档和设计文档的撰写。
6）负责项目的技术分享，参与了项目的技术分享和知识传递。

## 职业发展，你对自己的未来规划是什么样的？
